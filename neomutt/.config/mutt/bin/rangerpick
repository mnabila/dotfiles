#!/bin/sh
# source: https://www.reddit.com/r/commandline/comments/cbxvdf/combine_neomutt_with_ranger/

# add this to muttrc
# macro compose A "<shell-escape>bash $HOME/.config/mutt/bin/rangerpick<enter><enter-command>source /tmp/rangerpick<enter><shell-escape>bash $HOME/.config/mutt/bin/rangerpick clean<enter>" "Attach with Ranger"

tmpfile=/tmp/rangerpick
if \[ -z "$1" \]; then
   ranger --choosefiles $tmpfile && echo "$(awk 'BEGIN {printf "%s", "push "} {printf "%s", "<attach-file>"$0"<enter>"}'  $tmpfile)" > $tmpfile
elif \[ $1 == "clean" \]; then
  rm $tmpfile
fi
